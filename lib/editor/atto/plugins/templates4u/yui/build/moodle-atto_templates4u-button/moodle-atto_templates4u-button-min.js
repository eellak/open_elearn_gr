YUI.add("moodle-atto_templates4u-button",function(e,t){var n="atto_templates4u",r={TEMPLATENAME:"atto_templates4u_name",PREVIEW:"atto_templates4u_preview",INSERT:"atto_templates4u_insert",CANCEL:"atto_templates4u_cancel"},i={TEMPLATES:"."+r.TEMPLATENAME,INSERT:"."+r.INSERT,PREVIEW:"."+r.PREVIEW,CANCEL:"."+r.CANCEL},s={FORM:'<form class="atto_form"><div class="form-group"><label for="{{elementid}}_{{CSS.TEMPLATENAME}}">{{{get_string "selectatemplate" component}}}</label><select class="{{CSS.TEMPLATENAME}} form-control" id="{{elementid}}_{{CSS.TEMPLATENAME}}" name="{{elementid}}_{{CSS.TEMPLATENAME}}"><option value="">{{get_string "selectatemplate" component}}</option>{{#each templates}}<option value="{{templatekey}}">{{templatekey}}</option>{{/each}}</select></div><label for="{{elementid}}_{{CSS.PREVIEW}}">{{get_string "preview" component}}</label><div class="card"><div class="card-block {{CSS.PREVIEW}}" id="{{elementid}}_{{CSS.PREVIEW}}"></div></div><div class="mdl-align"><button class="btn btn-primary {{CSS.INSERT}}">{{get_string "insert" component}}</button> <button class="btn btn-secondary {{CSS.CANCEL}}">{{get_string "cancel" component}}</button></div></form>'};e.namespace("M.atto_templates4u").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{_content:null,_templates:[],initializer:function(){if(!this.get("enablebutton"))return;this.addButton({icon:"icon",iconComponent:n,callback:this._displayDialogue}),this._templates=this.get("templates")},_displayDialogue:function(){var e=this.getDialogue({headerContent:M.util.get_string("pluginname",n),focusAfterHide:!0,width:600}),t=this._getDialogueContent();e.set("bodyContent",t),e.show()},_getDialogueContent:function(){var t=e.Handlebars.compile(s.FORM);return this._templates=this.get("templates"),this._content=e.Node.create(t({elementid:this.get("host").get("elementid"),component:n,templates:this._templates,CSS:r})),this._content.one(i.TEMPLATES).on("change",this._previewTemplate,this),this._content.one(i.INSERT).on("click",this._insertTemplate,this),this._content.one(i.CANCEL).on("click",this._cancel,this),this._content},_previewTemplate:function(t){var n,r,s;n=t.currentTarget,r=n.get("value");var o=this._templateFilter(r);s=e.one(i.PREVIEW),s.setHTML(o.template)},_insertTemplate:function(t){var n,r,s,o;s=this.get("host"),t.preventDefault(),this.getDialogue({focusAfterHide:null}).hide(),n=e.one(i.TEMPLATES),r=n.get("value"),o=this._templateFilter(r),s.insertContentAtFocusPoint(o.template),this.markUpdated()},_cancel:function(e){e.preventDefault(),this.getDialogue().hide()},_templateFilter:function(e){for(var t=0;t<this._templates.length;t++)if(this._templates[t].templatekey==e)return this._templates[t];return[]}},{ATTRS:{templates:{value:{}},enablebutton:{value:!1}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
